<?xml version="1.0" encoding="UTF-8" ?>

<rules>
    <rule type="collection">
        <trigger field="gnm_storage_rule_sensitive"/>
        <input field="itemId"/>

        <![CDATA[
           from portal.plugins.gnmpropagation import tasks

           logger = logging.getLogger(__name__)
           logger.info("Starting propagation from {0}".format(itemId))

           tasks.propagate.delay(itemId, 'gnm_storage_rule_sensitive', gnm_storage_rule_sensitive)
           logger.info("Propagation task scheduled")
        ]]>
    </rule>

    <rule type="collection">
        <trigger field="gnm_storage_rule_deletable"/>
        <input field="itemId"/>

        <![CDATA[
           from portal.plugins.gnmpropagation import tasks

           logger = logging.getLogger(__name__)
           logger.info("Starting propagation from {0}".format(itemId))

           tasks.propagate.delay(itemId, 'gnm_storage_rule_sensitive', gnm_storage_rule_sensitive)
           logger.info("Propagation task scheduled")
        ]]>
    </rule>

    <rule type="collection">
        <trigger field="gnm_storage_rule_deep_archive"/>
        <input field="itemId"/>
        <![CDATA[
           from portal.plugins.gnmpropagation import tasks

           logger = logging.getLogger(__name__)
           logger.info("Starting propagation from {0}".format(itemId))

           tasks.propagate.delay(itemId, 'gnm_storage_rule_sensitive', gnm_storage_rule_sensitive)
           logger.info("Propagation task scheduled")
        ]]>
    </rule>
</rules>